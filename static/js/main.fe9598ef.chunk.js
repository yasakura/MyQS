(this["webpackJsonpmy-qs"]=this["webpackJsonpmy-qs"]||[]).push([[0],{111:function(e,t,n){},112:function(e,t,n){},120:function(e,t,n){},121:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(43),c=n.n(r),o=(n(111),n(112),n(12)),l=n(174),s=function(e){alert("Une erreur est survenue, recommence \ud83d\ude1c"),console.error("errorCode",null===e||void 0===e?void 0:e.code),console.error("errorMessage",null===e||void 0===e?void 0:e.message)},u=n(6),d=n(1),j=n.n(d),b=n(34),v=n(61),p=n(88),h=n(25),O=Object(p.a)({apiKey:"AIzaSyBF25OZgwRM4sJomPY03QNkEndvXF7FMdI",authDomain:"myqs-1ab0a.firebaseapp.com",databaseURL:"https://myqs-1ab0a-default-rtdb.europe-west1.firebasedatabase.app",projectId:"myqs-1ab0a",storageBucket:"myqs-1ab0a.appspot.com",messagingSenderId:"405974773090",appId:"1:405974773090:web:a638f39dc508d46e3ad03b"}),f=Object(h.a)(O),x=Object(b.b)(),m=function(){Object(b.i)(x)},g=function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(b.c)(x,window.location.href)){e.next=5;break}return(t=window.localStorage.getItem("emailForSignIn"))||(t=window.prompt("Entrez votre email pour confirmation")),e.next=5,Object(b.h)(x,t,window.location.href).then((function(){window.localStorage.removeItem("emailForSignIn"),window.location.search=""})).catch((function(e){"auth/invalid-action-code"!==(null===e||void 0===e?void 0:e.code)&&s(e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(v.a)(x),t=Object(o.a)(e,2);return{user:t[0],loadingUser:t[1]}},y=n(171),S=n(166),k=n(3),I=function(e){var t=e.isEmailOnError,n=e.setEmailOnError,i=Object(a.useState)(" "),r=Object(o.a)(i,2),c=r[0],l=r[1],s=function(){n(!1),l(" ")};return Object(k.jsx)(y.a,{children:Object(k.jsx)(S.a,{id:"email",type:"email",label:"email",placeholder:"Entrez votre email",sx:{width:263,marginBottom:"10px","& .MuiOutlinedInput-notchedOutline":{borderColor:"black"},"& .MuiInputLabel-root":{color:"black"}},required:!0,onBlur:function(e){var t=e.target.value,a=0===t.length,i=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(t);switch(!0){case a:n(!0),l("Tu n'as pas rempli ton email");break;case!i:n(!0),l("Le format de l'email n'est pas bon");break;default:s()}},onChange:function(e){t&&/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e.target.value)&&s()},error:t,helperText:c})})},C=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(!1),c=Object(o.a)(r,2),u=c[0],d=c[1],j=function(e){i(!0),function(e){var t={url:window.location.href,handleCodeInApp:!0};return Promise.resolve(Object(b.f)(x,e,t))}(e).then((function(){window.localStorage.setItem("emailForSignIn",e),alert("Tu vas recevoir un mail pour te connecter \ud83d\udc8c"),i(!1)})).catch((function(e){s(e),i(!1)}))};return Object(k.jsx)("div",{style:{height:"calc(100vh - 200px)",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(k.jsxs)("form",{onSubmit:function(e){var t,n,a;e.preventDefault();var i=null===e||void 0===e||null===(t=e.target)||void 0===t||null===(n=t.elements)||void 0===n||null===(a=n.email)||void 0===a?void 0:a.value;u||j(i)},children:[Object(k.jsx)(I,{isEmailOnError:u,setEmailOnError:d}),Object(k.jsx)(l.a,{type:"submit",variant:"contained",disabled:n,children:n?"Patiente un peu \ud83d\ude80":"Recevoir le lien de connexion"})]})})},D=n(21),E=n(57),M=n(168),P=n(170),F=function(e){var t,n=e.snackPack,r=e.setSnackPack,c=Object(a.useState)(!1),l=Object(o.a)(c,2),s=l[0],u=l[1],d=i.a.useState(void 0),j=Object(o.a)(d,2),b=j[0],v=j[1];return i.a.useEffect((function(){n.length&&!b?(v(Object(E.a)({},n[0])),r((function(e){return e.slice(1)})),u(!0)):n.length&&b&&s&&u(!1)}),[n,r,b,s]),Object(k.jsx)(P.a,{TransitionProps:{onExited:function(){v(void 0)}},anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,onClose:function(e,t){"clickaway"!==t&&u(!1)},open:s,children:Object(k.jsx)(M.a,{severity:"success",children:"Repas enregistr\xe9"})},null!==(t=null===b||void 0===b?void 0:b.key)&&void 0!==t?t:void 0)},A=n(92),B=function(){var e=Object(v.a)(x),t=Object(o.a)(e,1)[0],n=null===t||void 0===t?void 0:t.uid,a=Object(A.a)(Object(h.h)(f,"users/".concat(n))),i=Object(o.a)(a,2);return{diets:i[0]||[],loadingDiets:i[1]}},q=function(){return Math.random().toString().slice(2,9)},T=n(172),L=n(176),N=n(169),z=function(e){var t,n,a=e.data,i=e.sx;return Object(k.jsx)("div",{style:{marginBottom:"40px"},children:Object(k.jsx)(T.a,{row:!0,"aria-label":"position",name:null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.name,defaultValue:null===a||void 0===a||null===(n=a[0])||void 0===n?void 0:n.value,sx:{justifyContent:"space-between",width:"100%"},children:a.map((function(e){return Object(k.jsx)(L.a,{value:null===e||void 0===e?void 0:e.value,control:Object(k.jsx)(N.a,{size:"small"}),label:null===e||void 0===e?void 0:e.label,labelPlacement:"top",sx:i},q())}))})})},R=n(93),J=n(94),U=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],i=t[1],r=w().user,c=B().diets,s=function(){i((function(e){return[].concat(Object(D.a)(e),[{key:q()}])}))},u={border:"solid 1px black",height:"100px",borderRadius:"5px",justifyContent:"center",padding:"5px",width:"100px",margin:0},d=Object(E.a)(Object(E.a)({},u),{},{width:"65px",height:"65px"});return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.date.value,n=e.target.diet.value,a=e.target.meal.value;(function(e,t){return Object(h.i)(Object(h.h)(f,"users/".concat(null===e||void 0===e?void 0:e.uid)),t)})(r,function(e,t,n){var a=c,i={date:e,diet:t,meal:n},r=function(e){return i.date===e.date&&i.meal===e.meal},o=a.filter(r),l=a.findIndex(r);return o.length>0&&a.splice(l,o.length),[].concat(Object(D.a)(a),[i])}(t,n,a)).then(s)},children:[Object(k.jsxs)(y.a,{component:"fieldset",sx:{width:"100%"},children:[Object(k.jsx)("div",{style:{textAlign:"center",marginBottom:"40px"},children:Object(k.jsx)(S.a,{id:"date",label:"Date du repas",type:"date",sx:{width:220,"& .MuiOutlinedInput-notchedOutline":{borderColor:"black"},"& .MuiInputLabel-root":{color:"black"}},InputLabelProps:{shrink:!0},required:!0})}),Object(k.jsx)(z,{sx:d,data:R}),Object(k.jsx)(z,{sx:u,data:J})]}),Object(k.jsx)(l.a,{type:"submit",variant:"contained",children:"Enregistrer"})]}),Object(k.jsx)(F,{snackPack:n,setSnackPack:i})]})},G=n(95),Q=function(e){var t=e.diets,n=e.data,a=e.label;return Object(k.jsx)("div",{style:{width:"70%",height:"300px",margin:"0 auto 30px"},children:0===t.length?Object(k.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:Object(k.jsx)("p",{children:"Remplis le formulaire \ud83d\ude09"})}):Object(k.jsx)(G.PieChart,{data:n,label:a,labelStyle:{fontSize:"6px"}})})},V=function(){var e=w().user,t=B().diets,n=function(){var e=new Date,n=t.reduce((function(e,t){return e.push(t.date),e}),[]);return Object(D.a)(n).sort((function(t,n){return Math.abs(new Date(t)-e)-Math.abs(new Date(n)-e)}))[0]},a=n()?new Date(n()).toLocaleDateString("fr"):"Aucune \ud83e\udd37\u200d";return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(Q,{diets:t,data:function(){var e=t,n=e.filter((function(e){return"vegan"===e.diet})),a=e.filter((function(e){return"vegetarian"===e.diet})),i=e.filter((function(e){return"omnivore"===e.diet}));return[{title:"vegan",value:n.length,color:"#75DBCD"},{title:"v\xe9g\xe9tarien",value:a.length,color:"#FAA381"},{title:"omnivore",value:i.length,color:"#DCDBA8"}]}(),label:function(e){var t=e.dataEntry;return t.value>0?"".concat(t.title," : ").concat(Math.round(t.percentage),"%"):null}}),Object(k.jsx)(U,{}),Object(k.jsxs)("div",{children:[Object(k.jsxs)("p",{children:["Nombre de jours : ",function(){var e=t.reduce((function(e,t){return e.push(t.date),e}),[]);return e.filter((function(t,n){return e.indexOf(t)===n})).length}()]}),Object(k.jsxs)("p",{children:["Date la plus proche renseign\xe9e : ",a]})]}),Object(k.jsx)("hr",{}),e&&Object(k.jsxs)("div",{children:[Object(k.jsxs)("p",{children:["Utilisateur: ",e.email]}),Object(k.jsx)(l.a,{onClick:m,type:"submit",variant:"outlined",children:"Se d\xe9connecter"})]}),Object(k.jsx)("hr",{}),Object(k.jsx)("br",{})]})},W=n(178),$=n(179),H=n(180),K=n(177),X=function(){return Object(k.jsx)(W.a,{sx:{flexGrow:1},children:Object(k.jsx)($.a,{position:"fixed",children:Object(k.jsx)(H.a,{children:Object(k.jsx)(K.a,{variant:"h6",component:"div",sx:{flexGrow:1,textAlign:"center"},children:"My QS"})})})})},Y=(n(120),function(){return Object(k.jsxs)("div",{className:"App",style:{maxWidth:"375px",margin:"0 auto",padding:"0 10px"},children:[Object(k.jsx)("header",{style:{margin:"20px 0"},children:"My QS"}),Object(k.jsx)("div",{style:{height:"calc(100vh - 200px)",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(k.jsxs)("div",{className:"loading",children:[Object(k.jsx)(W.a,{component:"p",children:"Patiente pendant que la magie op\xe8re \u2728"}),Object(k.jsx)("span",{}),Object(k.jsx)("span",{}),Object(k.jsx)("span",{}),Object(k.jsx)("span",{}),Object(k.jsx)("span",{}),Object(k.jsx)("span",{}),Object(k.jsx)("span",{})]})})]})}),Z=function(e){var t=e.children,n=Object(a.useState)(!0),i=Object(o.a)(n,2),r=i[0],c=i[1],l=B().loadingDiets,s=w().loadingUser||l;return Object(a.useEffect)((function(){s?setTimeout((function(){return c(!0)}),500):setTimeout((function(){return c(!1)}),500)}),[c,s]),r?Object(k.jsx)(Y,{}):t};var _=function(){var e=w().user;return Object(a.useEffect)((function(){return g()})),Object(k.jsxs)(Z,{children:[Object(k.jsx)(X,{}),Object(k.jsx)("div",{className:"App",style:{margin:"0 auto",marginTop:"70px",maxWidth:"375px",padding:"0 10px"},children:e?Object(k.jsx)(V,{}):Object(k.jsx)(C,{})})]})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,181)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))};c.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsx)(_,{})}),document.getElementById("root")),ee()},93:function(e){e.exports=JSON.parse('[{"label":"Matin","name":"meal","value":"breakfast"},{"label":"Midi","name":"meal","value":"lunch"},{"label":"Go\xfbter","name":"meal","value":"snack"},{"label":"Soir","name":"meal","value":"dinner"}]')},94:function(e){e.exports=JSON.parse('[{"label":"V\xe9g\xe9tarien","name":"diet","value":"vegetarian"},{"label":"V\xe9gan","name":"diet","value":"vegan"},{"label":"Omnivore","name":"diet","value":"omnivore"}]')}},[[121,1,2]]]);
//# sourceMappingURL=main.fe9598ef.chunk.js.map