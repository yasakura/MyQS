(this["webpackJsonpmy-qs"]=this["webpackJsonpmy-qs"]||[]).push([[0],{120:function(e,t,n){},121:function(e,t,n){},129:function(e,t,n){},130:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(44),i=n.n(c),l=(n(120),n(121),n(98)),s=n(187),o=n(13),u=n(185),d=function(e){alert("Une erreur est survenue, recommence \ud83d\ude1c"),console.error("errorCode",null===e||void 0===e?void 0:e.code),console.error("errorMessage",null===e||void 0===e?void 0:e.message)},j=n(6),b=n(1),O=n.n(b),v=n(34),m=n(63),f=n(89),h=n(25),p=Object(f.a)({apiKey:"AIzaSyBF25OZgwRM4sJomPY03QNkEndvXF7FMdI",authDomain:"myqs-1ab0a.firebaseapp.com",databaseURL:"https://myqs-1ab0a-default-rtdb.europe-west1.firebasedatabase.app",projectId:"myqs-1ab0a",storageBucket:"myqs-1ab0a.appspot.com",messagingSenderId:"405974773090",appId:"1:405974773090:web:a638f39dc508d46e3ad03b"}),x=Object(h.a)(p),g=Object(v.b)(),w=function(){Object(v.i)(g)},S=function(){var e=Object(j.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(v.c)(g,window.location.href)){e.next=5;break}return(t=window.localStorage.getItem("emailForSignIn"))||(t=window.prompt("Entrez votre email pour confirmation")),e.next=5,Object(v.h)(g,t,window.location.href).then((function(){window.localStorage.removeItem("emailForSignIn"),window.location.search=""})).catch((function(e){"auth/invalid-action-code"!==(null===e||void 0===e?void 0:e.code)&&d(e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(m.a)(g),t=Object(o.a)(e,2);return{user:t[0],loadingUser:t[1]}},y=n(179),N=n(173),D=n(2),C=function(e){var t=e.isEmailOnError,n=e.setEmailOnError,r=Object(a.useState)(" "),c=Object(o.a)(r,2),i=c[0],l=c[1],s=function(){n(!1),l(" ")};return Object(D.jsx)(y.a,{children:Object(D.jsx)(N.a,{id:"email",type:"email",label:"email",className:"emailField",placeholder:"Entrez votre email",required:!0,onBlur:function(e){var t=e.target.value,a=0===t.length,r=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(t);switch(!0){case a:n(!0),l("Tu n'as pas rempli ton email");break;case!r:n(!0),l("Le format de l'email n'est pas bon");break;default:s()}},onChange:function(e){t&&/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(e.target.value)&&s()},error:t,helperText:i})})},E=n(183),F=n(184),I=n(189),M=n(191),P=function(e){var t=e.isAlertOpen,n=e.message,a=e.setAlertOpen;return Object(D.jsxs)(E.a,{open:t,children:[Object(D.jsx)(F.a,{children:Object(D.jsx)(I.a,{id:"alert-dialog-description",children:n})}),Object(D.jsx)(M.a,{children:Object(D.jsx)(u.a,{onClick:function(){return a(!1)},children:"J'ai compris \ud83d\ude01"})})]})},A=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),i=Object(o.a)(c,2),l=i[0],s=i[1],j=Object(a.useState)(!1),b=Object(o.a)(j,2),O=b[0],m=b[1],f=function(e){r(!0),function(e){var t={url:window.location.href,handleCodeInApp:!0};return Promise.resolve(Object(v.f)(g,e,t))}(e).then((function(){window.localStorage.setItem("emailForSignIn",e),m(!0),r(!1)})).catch((function(e){d(e),r(!1)}))};return Object(D.jsxs)("div",{className:"formContainer",children:[Object(D.jsxs)("form",{onSubmit:function(e){var t,n,a;e.preventDefault();var r=null===e||void 0===e||null===(t=e.target)||void 0===t||null===(n=t.elements)||void 0===n||null===(a=n.email)||void 0===a?void 0:a.value;l||f(r)},children:[Object(D.jsx)(C,{isEmailOnError:l,setEmailOnError:s}),Object(D.jsx)(u.a,{type:"submit",variant:"contained",disabled:n,children:n?"Patiente un peu \ud83d\ude80":"Recevoir le lien de connexion"})]}),Object(D.jsx)(P,{isAlertOpen:O,message:"Tu vas recevoir un mail pour te connecter \ud83d\udc8c",setAlertOpen:m})]})},T=n(21),q=n(186),B=n(193),z=n(93),L=n(175),J=n(178),R=function(e){var t,n=e.snackPack,c=e.setSnackPack,i=Object(a.useState)(!1),l=Object(o.a)(i,2),s=l[0],u=l[1],d=r.a.useState(void 0),j=Object(o.a)(d,2),b=j[0],O=j[1];return r.a.useEffect((function(){n.length&&!b?(O(Object(z.a)({},n[0])),c((function(e){return e.slice(1)})),u(!0)):n.length&&b&&s&&u(!1)}),[n,c,b,s]),Object(D.jsx)(J.a,{TransitionProps:{onExited:function(){O(void 0)}},anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,onClose:function(e,t){"clickaway"!==t&&u(!1)},open:s,children:Object(D.jsx)(L.a,{severity:"success",children:"Repas enregistr\xe9"})},null!==(t=null===b||void 0===b?void 0:b.key)&&void 0!==t?t:void 0)},U=n(94),V=function(){var e=Object(m.a)(g),t=Object(o.a)(e,1)[0],n=null===t||void 0===t?void 0:t.uid,a=Object(U.a)(Object(h.h)(x,"users/".concat(n))),r=Object(o.a)(a,2);return{diets:r[0]||[],loadingDiets:r[1]}},Y=function(){return Math.random().toString().slice(2,9)},G=n(180),Q=n(192),$=n(176),H=function(e){var t,n,a=e.data,r=e.cssClassName;return Object(D.jsx)("div",{className:"mb40",children:Object(D.jsx)(G.a,{row:!0,"aria-label":"position",name:null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.name,defaultValue:null===a||void 0===a||null===(n=a[0])||void 0===n?void 0:n.value,className:"radioGroup",children:a.map((function(e){return Object(D.jsx)(Q.a,{value:null===e||void 0===e?void 0:e.value,control:Object(D.jsx)($.a,{size:"small"}),label:null===e||void 0===e?void 0:e.label,labelPlacement:"top",className:r},Y())}))})})},K=n(95),X=n(96);var Z=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],r=t[1],c=k().user,i=V().diets,l=function(){r((function(e){return[].concat(Object(T.a)(e),[{key:Y()}])}))};return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.date.value,n=e.target.diet.value,a=e.target.meal.value;(function(e,t){return Object(h.i)(Object(h.h)(x,"users/".concat(null===e||void 0===e?void 0:e.uid)),t)})(c,function(e,t){var n=t,a=function(t){return e.date===t.date&&e.meal===t.meal},r=n.filter(a),c=n.findIndex(a);return r.length>0&&n.splice(c,r.length),[].concat(Object(T.a)(n),[e])}({date:t,diet:n,meal:a},i)).then(l)},children:[Object(D.jsxs)(y.a,{component:"fieldset",className:"w100",children:[Object(D.jsx)("div",{className:"dateContainer mb40",children:Object(D.jsx)(N.a,{id:"date",label:"Date du repas",type:"date",className:"dateField",InputLabelProps:{shrink:!0},required:!0})}),Object(D.jsx)(H,{cssClassName:"mealLabel",data:K}),Object(D.jsx)(H,{cssClassName:"label",data:X})]}),Object(D.jsx)(u.a,{type:"submit",variant:"contained",children:"Enregistrer"})]}),Object(D.jsx)(R,{snackPack:n,setSnackPack:r})]})},_=n(97),W=function(e){var t=e.diets,n=e.data,a=e.label;return Object(D.jsx)("div",{className:"chartContainer",children:0===t.length?Object(D.jsx)("div",{className:"chartEmpty",children:Object(D.jsx)("p",{children:"Remplis le formulaire \ud83d\ude09"})}):Object(D.jsx)(_.PieChart,{data:n,label:a,labelStyle:{fontSize:"6px"}})})},ee=function(){var e=k().user,t=V().diets,n=r.a.useState(),c=Object(o.a)(n,2),i=c[0],l=c[1],s=r.a.useState((function(){return["week"]})),d=Object(o.a)(s,2),j=d[0],b=d[1],O=Object(a.useCallback)((function(e){var n=t.filter((function(t){var n=new Date(t.date),a=new Date;if("week"===e){var r=new Date;return n>r.setDate(r.getDate()-7)}return"month"===e?n>a.setMonth(a.getMonth()-1):"year"!==e||n>a.setFullYear(a.getFullYear()-1)})),a=n.filter((function(e){return"vegan"===e.diet})),r=n.filter((function(e){return"vegetarian"===e.diet})),c=n.filter((function(e){return"omnivore"===e.diet}));l([{title:"vegan",value:a.length,color:"#75DBCD"},{title:"v\xe9g\xe9tarien",value:r.length,color:"#FAA381"},{title:"omnivore",value:c.length,color:"#DCDBA8"}])}),[t]);Object(a.useEffect)((function(){O("week")}),[t,O]);var v=function(){var e=new Date,n=t.reduce((function(e,t){return e.push(t.date),e}),[]);return Object(T.a)(n).sort((function(t,n){return Math.abs(new Date(t)-e)-Math.abs(new Date(n)-e)}))[0]},m=v()?new Date(v()).toLocaleDateString("fr"):"Aucune \ud83e\udd37\u200d";return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(q.a,{value:j,color:"primary",className:"periodButton",exclusive:!0,onChange:function(e,t){O(t),b(t)},size:"small",children:[Object(D.jsx)(B.a,{value:"week",children:"Semaine"}),Object(D.jsx)(B.a,{value:"month",children:"Mois"}),Object(D.jsx)(B.a,{value:"year",children:"Ann\xe9e"}),Object(D.jsx)(B.a,{value:"all",children:"Tout"})]}),Object(D.jsx)(W,{diets:t,data:i,label:function(e){var t=e.dataEntry;return t.value>0?"".concat(t.title," : ").concat(Math.round(t.percentage),"%"):null}}),Object(D.jsx)(Z,{}),Object(D.jsxs)("div",{children:[Object(D.jsxs)("p",{children:["Nombre de jours : ",function(){var e=t.reduce((function(e,t){return e.push(t.date),e}),[]);return e.filter((function(t,n){return e.indexOf(t)===n})).length}()]}),Object(D.jsxs)("p",{children:["Date la plus proche renseign\xe9e : ",m]})]}),Object(D.jsx)("hr",{}),e&&Object(D.jsxs)("div",{children:[Object(D.jsxs)("p",{children:["Utilisateur: ",e.email]}),Object(D.jsx)(u.a,{onClick:w,className:"logOut",type:"submit",variant:"outlined",children:"Se d\xe9connecter"})]}),Object(D.jsx)("hr",{})]})},te=n(194),ne=n(195),ae=n(196),re=n(190),ce=function(){return Object(D.jsx)(te.a,{children:Object(D.jsx)(ne.a,{position:"fixed",children:Object(D.jsx)(ae.a,{children:Object(D.jsx)(re.a,{variant:"h6",component:"div",className:"appBarText",children:"My QS"})})})})},ie=(n(129),function(){return Object(D.jsxs)("div",{className:"App",children:[Object(D.jsx)(ce,{}),Object(D.jsx)("div",{className:"loadingContainer",children:Object(D.jsxs)("div",{className:"loading",children:[Object(D.jsx)(te.a,{component:"p",children:"Patiente pendant que la magie op\xe8re \u2728"}),Object(D.jsx)("span",{}),Object(D.jsx)("span",{}),Object(D.jsx)("span",{}),Object(D.jsx)("span",{}),Object(D.jsx)("span",{}),Object(D.jsx)("span",{}),Object(D.jsx)("span",{})]})})]})}),le=function(e){var t=e.children,n=Object(a.useState)(!0),r=Object(o.a)(n,2),c=r[0],i=r[1],l=V().loadingDiets,s=k().loadingUser||l;return Object(a.useEffect)((function(){s?setTimeout((function(){return i(!0)}),500):setTimeout((function(){return i(!1)}),500)}),[i,s]),c?Object(D.jsx)(ie,{}):t},se=function(){return Object(D.jsx)("footer",{children:Object(D.jsx)(re.a,{children:"Fait avec \u2764\ufe0f par yasakura_"})})};var oe=function(){var e=k().user,t=Object(l.a)({palette:{primary:{main:"#007ea7"}}});return Object(a.useEffect)((function(){return S()})),Object(D.jsx)(s.a,{theme:t,children:Object(D.jsxs)(le,{children:[Object(D.jsx)(ce,{}),Object(D.jsx)("div",{className:"App",children:e?Object(D.jsx)(ee,{}):Object(D.jsx)(A,{})}),e&&Object(D.jsx)(se,{})]})})},ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,197)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(oe,{})}),document.getElementById("root")),ue()},95:function(e){e.exports=JSON.parse('[{"label":"Matin","name":"meal","value":"breakfast"},{"label":"Midi","name":"meal","value":"lunch"},{"label":"Go\xfbter","name":"meal","value":"snack"},{"label":"Soir","name":"meal","value":"dinner"}]')},96:function(e){e.exports=JSON.parse('[{"label":"V\xe9g\xe9tarien","name":"diet","value":"vegetarian"},{"label":"V\xe9gan","name":"diet","value":"vegan"},{"label":"Omnivore","name":"diet","value":"omnivore"}]')}},[[130,1,2]]]);
//# sourceMappingURL=main.59897eb2.chunk.js.map